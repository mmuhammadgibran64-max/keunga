<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIBRAN HUB - LOGIN SYSTEM</title>
    <style>
        :root { --bg: #0d1117; --card: #161b22; --accent: #2f81f7; --text: #c9d1d9; --border: #30363d; --success: #238636; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        
        .login-box { background: var(--card); border: 1px solid var(--border); padding: 30px; border-radius: 12px; width: 100%; max-width: 400px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        h2 { text-align: center; color: var(--accent); margin-bottom: 25px; }
        
        label { display: block; margin-bottom: 8px; font-size: 14px; color: #8b949e; }
        input { width: 100%; padding: 12px; margin-bottom: 20px; background: #010409; border: 1px solid var(--border); color: white; border-radius: 6px; box-sizing: border-box; }
        
        .btn-primary { width: 100%; padding: 12px; background: var(--accent); color: white; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-primary:hover { background: #1f6feb; }
        
        .btn-secondary { width: 100%; padding: 12px; background: transparent; color: var(--accent); border: 1px solid var(--accent); border-radius: 6px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        
        .msg { text-align: center; margin-top: 15px; font-size: 13px; display: none; }
    </style>
</head>
<body>

<div class="login-box" id="authBox">
    <h2 id="title">GIBRAN HUB LOGIN</h2>
    
    <form id="authForm">
        <label>Nama Pengguna</label>
        <input type="text" id="username" name="username" placeholder="Masukkan nama..." required>
        
        <label>Password</label>
        <input type="password" id="password" name="password" placeholder="••••••••" required>
        
        <button type="submit" id="mainBtn" class="btn-primary">MASUK</button>
        <button type="button" id="switchBtn" class="btn-secondary">DAFTAR AKUN BARU</button>
    </form>
    
    <div id="statusMsg" class="msg"></div>
</div>

<script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbwOFaA_xT3iffh_0JYNiJjacx4SJWsQmeHnVcCcpdRRAsaSbjmtoHIr0dMmWNAVEO1a/exec';
    const form = document.getElementById('authForm');
    const title = document.getElementById('title');
    const mainBtn = document.getElementById('mainBtn');
    const switchBtn = document.getElementById('switchBtn');
    const statusMsg = document.getElementById('statusMsg');

    let isLoginMode = true;

    // Fungsi Switch antara Login & Daftar
    switchBtn.addEventListener('click', () => {
        isLoginMode = !isLoginMode;
        title.innerText = isLoginMode ? "GIBRAN HUB LOGIN" : "DAFTAR AKUN BARU";
        mainBtn.innerText = isLoginMode ? "MASUK" : "DAFTAR SEKARANG";
        switchBtn.innerText = isLoginMode ? "DAFTAR AKUN BARU" : "SUDAH PUNYA AKUN? LOGIN";
    });

    form.addEventListener('submit', e => {
        e.preventDefault();
        statusMsg.style.display = 'block';
        statusMsg.innerText = "Memproses...";
        statusMsg.style.color = 'var(--text)';

        const formData = new FormData(form);
        // Tambahkan action biar Google Script tau ini mau login atau daftar
        formData.append('action', isLoginMode ? 'login' : 'register');

        fetch(scriptURL, { method: 'POST', body: formData})
        .then(response => response.json())
        .then(res => {
            if (res.result === "success") {
                statusMsg.innerText = isLoginMode ? "Login Berhasil! Mengalihkan..." : "Pendaftaran Berhasil! Silakan Login.";
                statusMsg.style.color = 'var(--success)';
                
                if (isLoginMode) {
                    // Redirect ke Dashboard lo setelah 1.5 detik
                    setTimeout(() => {
                        window.location.href = "dashboard.html";
                    }, 1500);
                } else {
                    form.reset();
                    // Balik ke mode login
                    switchBtn.click();
                }
            } else {
                statusMsg.innerText = "Error: " + res.message;
                statusMsg.style.color = 'red';
            }
        })
        .catch(error => {
            statusMsg.innerText = "Gagal terhubung ke server!";
            statusMsg.style.color = 'red';
            console.error('Error!', error.message);
        });
    });
</script>

</body>
</html>
