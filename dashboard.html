<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard Gibran</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #e9ecef; padding: 20px; }
        .container { max-width: 600px; margin: auto; background: white; padding: 25px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .user-box { display: flex; align-items: center; gap: 10px; background: #f8f9fa; padding: 10px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #ddd; }
        .form-section { border: 1px solid #ddd; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        h3 { margin: 0 0 15px 0; color: #333; border-bottom: 2px solid #007bff; padding-bottom: 5px; }
        label { display: block; margin: 10px 0 5px; font-weight: bold; font-size: 14px; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; margin-top: 15px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; color: white; transition: 0.3s; }
        .btn-green { background: #28a745; }
        .btn-blue { background: #007bff; }
    </style>
</head>
<body>
<div class="container">
    <div class="user-box">
        <img id="profilePic" src="" width="40" style="border-radius: 50%">
        <div><b id="dispName"></b><br><small id="dispEmail"></small></div>
    </div>

    <div class="form-section">
        <h3>ðŸ’° FORM SETORAN</h3>
        <label>Nama yang Setor</label><input type="text" id="nama_setor">
        <label>Tanggal Setor</label><input type="date" id="tgl_setor">
        <label>Setor Ke Siapa</label>
        <select id="setor_ke"><option value="Bu Ami">Bu Ami</option><option value="Bu Tati">Bu Tati</option></select>
        <label>Bukti / Keterangan</label><input type="text" id="bukti_setor">
        <button class="btn-green" onclick="kirim('SETORAN')">Kirim Setoran</button>
    </div>

    <div class="form-section">
        <h3>ðŸ“‹ FORM LAPORAN</h3>
        <label>Nama yang Lapor</label><input type="text" id="nama_lapor">
        <label>Tanggal Lapor</label><input type="date" id="tgl_lapor">
        <label>Lapor Ke Siapa</label>
        <select id="lapor_ke"><option value="Bu Ami">Bu Ami</option><option value="Bu Tati">Bu Tati</option></select>
        <label>Bukti / Keterangan</label><input type="text" id="bukti_lapor">
        <button class="btn-blue" onclick="kirim('LAPORAN')">Kirim Laporan</button>
    </div>
</div>

<script>
   const scriptURL = 'https://script.google.com/macros/s/AKfycbxGoAWNS5xQWwrOnuHAyZdzEw8ZEC8SPPKKKtAqxSAveEp6716-8_to2Ou9s6Qq484/exec';

    function kirim(tipe) {
        let payload = { 
            "tipe": tipe,
            "sheetName": "tempat masuk nya data" // Tambahan: Nama sheet tujuan lo
        };

        if(tipe === 'SETORAN') {
            payload.nama = document.getElementById('nama_setor').value;
            payload.tanggal = document.getElementById('tgl_setor').value;
            payload.tujuan = document.getElementById('setor_ke').value;
            payload.bukti = document.getElementById('bukti_setor').value;
        } else {
            payload.nama = document.getElementById('nama_lapor').value;
            payload.tanggal = document.getElementById('tgl_lapor').value;
            payload.tujuan = document.getElementById('lapor_ke').value;
            payload.bukti = document.getElementById('bukti_lapor').value;
        }

        fetch(scriptURL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(payload) })
        .then(() => alert("Mantap! Data " + tipe + " Berhasil Masuk ke sheet 'tempat masuk nya data'!"))
        .catch(err => alert("Gagal kirim: " + err));
    }
    <script>
    // 1. Mengambil data dari localStorage (Hasil Login)
    document.getElementById('dispName').innerText = localStorage.getItem('userName');
    document.getElementById('dispEmail').innerText = localStorage.getItem('userEmail');
    document.getElementById('profilePic').src = localStorage.getItem('userPic');
    
    // Auto-fill nama di form agar user tidak repot mengetik nama sendiri
    document.getElementById('nama_setor').value = localStorage.getItem('userName');
    document.getElementById('nama_lapor').value = localStorage.getItem('userName');

    // 2. URL Apps Script lo
    const scriptURL = 'https://script.google.com/macros/s/AKfycbxGoAWNS5xQWwrOnuHAyZdzEw8ZEC8SPPKKKtAqxSAveEp6716-8_to2Ou9s6Qq484/exec';

    // 3. Fungsi Kirim Data Baru (Sudah pakai target Sheet)
    function kirim(tipe) {
        let payload = { 
            "tipe": tipe,
            "sheetName": "tempat masuk nya data" // Ini perintah supaya masuk ke tab spesifik
        };

        if(tipe === 'SETORAN') {
            payload.nama = document.getElementById('nama_setor').value;
            payload.tanggal = document.getElementById('tgl_setor').value;
            payload.tujuan = document.getElementById('setor_ke').value;
            payload.bukti = document.getElementById('bukti_setor').value;
        } else {
            payload.nama = document.getElementById('nama_lapor').value;
            payload.tanggal = document.getElementById('tgl_lapor').value;
            payload.tujuan = document.getElementById('lapor_ke').value;
            payload.bukti = document.getElementById('bukti_lapor').value;
        }

        // Proses pengiriman
        fetch(scriptURL, { 
            method: 'POST', 
            mode: 'no-cors', 
            body: JSON.stringify(payload) 
        })
        .then(() => {
            alert("Mantap! Data " + tipe + " Berhasil Terkirim ke sheet 'tempat masuk nya data'!");
        })
        .catch(err => {
            alert("Waduh, Gagal: " + err);
        });
    }
</script><script type="text/javascript">
var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
(function(){
var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
s1.async=true;
s1.src='https://embed.tawk.to/6993e93bd5bd3b1c3ca44cb6/1ji9fnh51';
s1.charset='UTF-8';
s1.setAttribute('crossorigin','*');
s0.parentNode.insertBefore(s1,s0);
})();
</script></body>

</html>
